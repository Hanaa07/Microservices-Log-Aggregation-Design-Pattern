# Log Aggregation System

## Overview

This class diagram represents a **Log Aggregation System** where logs are generated by different services and aggregated centrally for storage and display. The system includes the following components:

![image](https://github.com/user-attachments/assets/f06779ad-1f67-44c0-aa3a-5a77e498a077)

1. **App**: The entry point for running the application.
2. **CentralLogStore**: Stores logs and displays them.
3. **LogAggregator**: Aggregates logs and handles buffer flushing.
4. **LogEntry**: Represents an individual log entry.
5. **LogLevel**: Defines different levels of logging (e.g., DEBUG, ERROR, INFO).
6. **LogProducer**: Generates log entries and sends them to the aggregator.

---

## Key Classes and Components

### 1. **App**

- **Methods**:
  - `App()`: Constructor for the `App` class.
  - `main(args: String[])`: The entry point of the application. This method is static and serves to start the log aggregation process.

### 2. **CentralLogStore**

- **Attributes**:
  - `LOGGER`: A static `Logger` instance used for logging operations.
  - `logs`: A `ConcurrentLinkedQueue<LogEntry>` to store incoming log entries.

- **Methods**:
  - `CentralLogStore()`: Constructor for the `CentralLogStore` class.
  - `displayLogs()`: Displays all stored logs.
  - `storeLog(logEntry: LogEntry)`: Stores a log entry in the queue.

### 3. **LogAggregator**

- **Attributes**:
  - `BUFFER_THRESHOLD`: A static threshold that determines when the log buffer should be flushed.
  - `LOGGER`: A static `Logger` instance used for logging operations.
  - `buffer`: A `ConcurrentLinkedQueue<LogEntry>` that temporarily holds log entries before they are stored in the central log store.
  - `centralLogStore`: A reference to the `CentralLogStore` for storing logs.
  - `executorService`: A service that handles background tasks, such as flushing the buffer.
  - `logCount`: An `AtomicInteger` that keeps track of the number of log entries processed.
  - `minLogLevel`: The minimum log level required for logs to be processed.

- **Methods**:
  - `LogAggregator(centralLogStore: CentralLogStore, minLogLevel: LogLevel)`: Constructor that initializes the aggregator with the central log store and minimum log level.
  - `collectLog(logEntry: LogEntry)`: Collects a log entry and adds it to the buffer.
  - `flushBuffer()`: Flushes the buffer by storing logs in the central log store.
  - `startBufferFlusher()`: Starts a background task to flush the buffer at regular intervals.
  - `stop()`: Stops the log aggregation process.

### 4. **LogEntry**

- **Attributes**:
  - `level`: The log level (e.g., DEBUG, ERROR).
  - `message`: The message of the log entry.
  - `serviceName`: The name of the service generating the log.
  - `timestamp`: The timestamp when the log entry was created.

- **Methods**:
  - `LogEntry(serviceName: String, level: LogLevel, message: String, timestamp: LocalDateTime)`: Constructor for creating a log entry.
  - `canEqual(other: Object)`: Checks if another object is equal to this log entry.
  - `equals(o: Object)`: Checks equality based on the log entry's properties.
  - `getLevel()`: Returns the log level.
  - `getMessage()`: Returns the log message.
  - `getServiceName()`: Returns the service name.
  - `getTimestamp()`: Returns the timestamp.
  - `hashCode()`: Returns the hash code for the log entry.
  - `setLevel(level: LogLevel)`: Sets the log level.
  - `setMessage(message: String)`: Sets the log message.
  - `setServiceName(serviceName: String)`: Sets the service name.
  - `setTimestamp(timestamp: LocalDateTime)`: Sets the timestamp.
  - `toString()`: Returns a string representation of the log entry.

### 5. **LogLevel (Enum)**

- Defines the various levels of logs:
  - `DEBUG`
  - `ERROR`
  - `INFO`
- **Methods**:
  - `valueOf(name: String)`: Returns the corresponding `LogLevel` based on the string name.
  - `values()`: Returns all possible `LogLevel` values.

### 6. **LogProducer**

- **Attributes**:
  - `LOGGER`: A static `Logger` instance for logging purposes.
  - `aggregator`: A reference to the `LogAggregator` for collecting logs.
  - `serviceName`: The name of the service generating the logs.

- **Methods**:
  - `LogProducer(serviceName: String, aggregator: LogAggregator)`: Constructor that initializes the log producer with the service name and the log aggregator.
  - `generateLog(level: LogLevel, message: String)`: Generates a log entry with the specified level and message.

---

## Relationships

- **LogAggregator** interacts with **CentralLogStore** to store and manage logs.
- **LogAggregator** collects **LogEntry** objects in a buffer before flushing them to the **CentralLogStore**.
- **LogProducer** generates **LogEntry** objects and sends them to **LogAggregator** for processing.
- **LogEntry** includes a reference to **LogLevel**, which defines the severity of the log entry.

---

## Benefits of the Log Aggregation System

1. **Centralized Log Storage**:
   - All logs are aggregated in a central store, making it easier to manage and analyze logs from different services.
   
2. **Efficient Buffering**:
   - Logs are buffered before being flushed to the central store, improving performance and reducing the number of writes to storage.

3. **Scalability**:
   - The system can handle large volumes of logs from multiple services efficiently using a concurrent data structure (`ConcurrentLinkedQueue`).

4. **Flexible Log Levels**:
   - Logs are categorized by severity levels (e.g., DEBUG, ERROR), allowing for better filtering and analysis.

---

## Conclusion

This log aggregation system efficiently collects and stores logs from different services, ensuring centralized and organized log management. By leveraging buffering and concurrent data structures, it is optimized for handling high volumes of logs. The system is extensible, allowing for easy integration of additional services and log producers.
